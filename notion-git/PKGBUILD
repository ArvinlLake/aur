pkgname=notion-git
pkgver=20110712
pkgrel=1
pkgdesc="Tabbed tiling, window manager. Fork of Ion3"
url="http://sourceforge.net/projects/notion/"
arch=('i686' 'x86_64')
license=('GPL')
depends=('glib2' 'gettext' 'lua' 'libxext' )
makedepends=('git' 'pkgconfig' )
conflicts=('ion3')
provides=('notion')
source=('system.mk')
md5sums=('7e0329d74ca6927cae887019ba9dcd30')

_gitroot="git://notion.git.sourceforge.net/gitroot/notion/notion"
_gitname="notion"

_gitroot2="git://notion.git.sourceforge.net/gitroot/notion/libtu"
_gitname2="libtu"

_gitroot3="git://notion.git.sourceforge.net/gitroot/notion/libextl"
_gitname3="libextl"


build() {
    cd ${srcdir}

    msg "Connecting to the git repository..."
    if [ -d ${srcdir}/${_gitname} ]; then
        cd ${_gitname}
        git pull origin
    else
        git clone --depth 1 ${_gitroot}
        cd ${_gitname}
    fi
    
    if [ -d ${srcdir}/${_gitname}/${_gitname2} ]; then
    echo
        git pull origin
    else
        git clone --depth 1 ${_gitroot2}
      echo
    fi
    
    if [ -d ${srcdir}/${_gitname}/${_gitname3} ]; then
    echo
        git pull origin
    else
        git clone --depth 1 ${_gitroot3}
    echo
    fi
    
    msg "GIT checkout done or server timeout"

    rm -rf ${srcdir}/${_gitname}-build
    cp -r  ${srcdir}/${_gitname} ${srcdir}/${_gitname}-build
    
    cd ${srcdir}/${_gitname}-build
    
    msg "Starting make..."
    cp -f $startdir/system.mk ./system.mk
    make PREFIX=${pkgdir}/usr INCLUDES=-I${srcdir}/${_gitname}-build || return 1
    make PREFIX=${pkgdir}/usr install || return 1
}


